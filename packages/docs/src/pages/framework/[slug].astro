---
import { getCollection } from 'astro:content'
import Layout from '../../layouts/Layout.astro'
import FrameworkDetail from '../../components/FrameworkDetail.astro'
import { getFrameworkSlug } from '../../lib/utils'

export async function getStaticPaths() {
  const devtimeEntries = await getCollection('devtime')
  const runtimeEntries = await getCollection('runtime')
  const baseline = runtimeEntries.find(
    (e) => e.data.package === 'app-baseline-html',
  )?.data
  return devtimeEntries.map((entry) => {
    const slug = getFrameworkSlug(entry.data.package)
    const runtimePackage = `app-${slug}`
    const runtimeEntry = runtimeEntries.find(
      (e) => e.data.package === runtimePackage,
    )
    return {
      params: { slug },
      props: {
        devtime: entry.data,
        runtime: runtimeEntry?.data,
        baseline,
      },
    }
  })
}

const { devtime, runtime, baseline } = Astro.props
---

<Layout title={`${devtime.name} â€” Framework Tracker`}>
  <section class="framework-page-section">
    <FrameworkDetail devtime={devtime} runtime={runtime} baseline={baseline} />
  </section>
</Layout>

<style>
  .framework-page-section {
    width: 100%;
    max-width: 900px;
    margin: 0 auto;
  }
</style>
